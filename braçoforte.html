<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Calculadora de Coberturas</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      -webkit-text-size-adjust: 100%;
    }
    
    body {
      font-family: Arial, sans-serif;
      line-height: 1.5;
      color: #333;
      background-color: #f5f5f5;
      padding: 10px;
    }
    
    .container {
      max-width: 100%;
      width: 100%;
      margin: 0 auto;
      background: white;
      border-radius: 8px;
      padding: 15px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    
    .logo {
      max-width: 150px;
      height: auto;
      margin: 0 auto 15px;
      display: block;
    }
    
    h1 {
      font-size: 1.5rem;
      color: #333;
      margin-bottom: 10px;
      text-align: center;
    }
    
    h1 p {
      font-size: 1.2rem;
      margin-top: 5px;
      color: #555;
    }
    
    .empresa-nome {
      text-align: center;
      font-weight: bold;
      margin-bottom: 20px;
      color: #444;
    }
    
    label {
      display: block;
      margin-top: 15px;
      margin-bottom: 5px;
      font-size: 0.95rem;
      color: #555;
    }
    
    input, select {
      width: 100%;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 5px;
      font-size: 1rem;
      margin-bottom: 5px;
      background: #fff;
    }
    
    input:focus, select:focus {
      border-color: #007BFF;
      outline: none;
    }
    
    button {
      width: 100%;
      padding: 12px;
      background-color: #007BFF;
      color: white;
      border: none;
      border-radius: 5px;
      font-size: 1rem;
      margin-top: 10px;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    
    button:hover {
      background-color: #0056b3;
    }
    
    .imagem-cobertura, .imagem-telha {
      max-width: 100%;
      height: auto;
      margin: 15px auto;
      display: block;
      border-radius: 5px;
    }
    
    .hidden {
      display: none;
    }
    
    .resultado {
      margin-top: 20px;
      padding: 15px;
      background-color: #f9f9f9;
      border-radius: 5px;
      border: 1px solid #eee;
    }
    
    .resultado p {
      margin-bottom: 10px;
    }
    
    .whatsapp-button {
      display: block;
      background-color: #25D366;
      color: white;
      text-align: center;
      padding: 12px;
      border-radius: 5px;
      text-decoration: none;
      margin: 20px auto;
      font-size: 1rem;
      animation: piscar 1.5s infinite;
    }
    
    @keyframes piscar {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.8; }
    }
    
    .instagram-link {
      display: block;
      text-align: center;
      color: #007BFF;
      text-decoration: none;
      margin: 10px auto;
      font-size: 0.95rem;
    }
    
    /* Estilos espec√≠ficos para mobile */
    @media (max-width: 480px) {
      .container {
        padding: 12px;
      }
      
      h1 {
        font-size: 1.3rem;
      }
      
      h1 p {
        font-size: 1.1rem;
      }
      
      label {
        font-size: 0.9rem;
      }
      
      input, select, button {
        padding: 10px;
        font-size: 0.95rem;
      }
      
      .logo {
        max-width: 120px;
      }
    }
    
    @media (max-width: 360px) {
      body {
        padding: 5px;
      }
      
      .container {
        padding: 10px;
      }
      
      h1 {
        font-size: 1.2rem;
      }
      
      input, select, button {
        padding: 8px;
        font-size: 0.9rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <img src="https://gabriellemoreira.com.br/wp-content/uploads/2025/02/braco-forte.jpeg" alt="Logotipo da Empresa" class="logo">

    <h1>Or√ßamento <p>Calculadora de Coberturas</p></h1>
    <p class="empresa-nome">EMPRESA DE COBERTURAS DE A√áOS DO KELVYN</p>

    <!-- Campos do cliente -->
    <label for="nomeCliente">Nome Completo (m√°x. 30 caracteres):</label>
    <input type="text" id="nomeCliente" maxlength="30" placeholder="Digite seu nome completo">

    <label for="telefoneCliente">Telefone:</label>
    <input type="tel" id="telefoneCliente" placeholder="00-00000-0000" pattern="\d{2}-\d{5}-\d{4}">

    <!-- Filtro de Tipo de Cobertura -->
    <label for="tipoCobertura">Tipo de Cobertura:</label>
    <select id="tipoCobertura">
      <option value="umaInclinacao">Selecione o formato do seu telhado</option>
      <option value="umaInclinacao">Uma inclina√ß√£o</option>
      <option value="duasAbasSimetricas">Duas abas sim√©tricas</option>
      <option value="duasAbasAssimetricas">Duas abas assim√©tricas</option>
    </select>

    <!-- Imagem da Cobertura -->
    <img id="imagemCobertura" src="" alt="Imagem do tipo de cobertura" class="imagem-cobertura hidden">

    <!-- Filtro de Telhas -->
    <label for="tipoTelha">Selecione a Telha:</label>
    <select id="tipoTelha">
      <optgroup label="Telhas de Zinco Trapezoidais">
        <option value="1.8x0.8">Selecione o tamanho e tipo de Telha</option>
        <option value="1.8x0.8">Telhas de Zinco Trapezoidais 1 (1,8x0,8 cm)</option>
        <option value="2.0x0.8">Telhas de Zinco Trapezoidais 2 (2,0x0,80 cm)</option>
        <option value="3.0x0.8">Telhas de Zinco Trapezoidais 3 (3,0x0,80 cm)</option>
        <option value="5.0x0.8">Telhas de Zinco Trapezoidais 4 (5,0x0,80 cm)</option>
        <option value="6.0x0.8">Telhas de Zinco Trapezoidais 5 (6,0x0,80 cm)</option>
        <option value="8.0x0.8">Telhas de Zinco Trapezoidais 6 (8,0x0,80 cm)</option>
        <option value="10.0x0.8">Telhas de Zinco Trapezoidais 7 (10,0x0,80 cm)</option>
        <option value="12.0x0.8">Telhas de Zinco Trapezoidais 8 (12,0x0,80 cm)</option>
      </optgroup>
      <optgroup label="Telhas de Zinco Onduladas">
        <option value="1.8x0.8">Telhas de Zinco Onduladas 1 (1,8x0,80 cm)</option>
        <option value="2.0x0.8">Telhas de Zinco Onduladas 2 (2,0x0,80 cm)</option>
        <option value="3.0x0.8">Telhas de Zinco Onduladas 3 (3,0x0,80 cm)</option>
        <option value="5.0x0.8">Telhas de Zinco Onduladas 4 (5,0x0,80 cm)</option>
        <option value="6.0x0.8">Telhas de Zinco Onduladas 5 (6,0x0,80 cm)</option>
        <option value="8.0x0.8">Telhas de Zinco Onduladas 6 (8,0x0,80 cm)</option>
        <option value="10.0x0.8">Telhas de Zinco Onduladas 7 (10,0x0,80 cm)</option>
        <option value="12.0x0.8">Telhas de Zinco Onduladas 8 (12,0x0,80 cm)</option>
      </optgroup>
    </select>

    <!-- Imagem da Telha -->
    <img id="imagemTelha" src="" alt="Imagem da telha selecionada" class="imagem-telha hidden">

    <!-- Campos de Metragem -->
    <label for="metragemA">A (m):</label>
    <input type="number" id="metragemA" placeholder="Insira a metragem A" step="0.01" min="0">

    <label for="metragemB">B (m):</label>
    <input type="number" id="metragemB" placeholder="Insira a metragem B" step="0.01" min="0">

    <label for="metragemC" class="hidden">C (m):</label>
    <input type="number" id="metragemC" placeholder="Insira a metragem C" step="0.01" min="0" class="hidden">

    <!-- Bot√£o de Calcular -->
    <button onclick="calcular()">Calcular</button>

    <!-- Resultado -->
    <div class="resultado hidden" id="resultado">
      <p>A superf√≠cie do telhado √©: <span id="areaTotal">0</span> m¬≤</p>
      <p>Voc√™ precisa: <span id="quantidadeTelhas">0</span> telhas</p>
      <p>Valor total: R$ <span id="valorTotal">0,00</span></p>
      <p id="detalhesSobreposicao"></p>
      <button onclick="gerarPDF()">Imprimir Or√ßamento em PDF</button>
      <button onclick="enviarWhatsApp()" style="background-color: #25D366; margin-top: 10px;">Enviar Or√ßamento via WhatsApp</button>
    </div>

    <!-- Bot√£o do WhatsApp -->
    <a href="https://wa.me/5521981304519" class="whatsapp-button" target="_blank">Chame no WhatsApp</a>

    <!-- Link do Instagram -->
    <a href="https://www.instagram.com/bracofortecoberturas/" class="instagram-link" target="_blank">Siga-nos no Instagram</a>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script>
    // URLs das imagens
    const imagensCobertura = {
      umaInclinacao: "https://gabriellemoreira.com.br/wp-content/uploads/2025/02/telhado-uma-inclinacao.png",
      duasAbasSimetricas: "https://gabriellemoreira.com.br/wp-content/uploads/2025/02/telhados-duas-abas-simetricas.png",
      duasAbasAssimetricas: "https://gabriellemoreira.com.br/wp-content/uploads/2025/02/Telhados-duas-abas-assimetricas.png"
    };

    const imagensTelhas = {
      trapezoidal: "https://gabriellemoreira.com.br/wp-content/uploads/2025/02/Captura-de-Tela-2025-02-19-as-01.02.31.png",
      ondulada: "https://gabriellemoreira.com.br/wp-content/uploads/2025/02/Captura-de-Tela-2025-02-19-as-01.11.18.png"
    };

    // Formatador de telefone
    document.getElementById('telefoneCliente').addEventListener('input', function (e) {
      let value = e.target.value.replace(/\D/g, '');
      if (value.length > 2) {
        value = value.substring(0, 2) + '-' + value.substring(2);
      }
      if (value.length > 8) {
        value = value.substring(0, 8) + '-' + value.substring(8, 12);
      }
      e.target.value = value;
    });

    // Atualizar imagem ao selecionar o tipo de cobertura
    document.getElementById("tipoCobertura").addEventListener("change", function () {
      const tipo = this.value;
      const imgCobertura = document.getElementById("imagemCobertura");
      imgCobertura.src = imagensCobertura[tipo];
      imgCobertura.classList.remove("hidden");

      // Mostrar/ocultar campo C para "Duas abas assim√©tricas"
      if (tipo === "duasAbasAssimetricas") {
        document.getElementById("metragemC").classList.remove("hidden");
        document.querySelector('label[for="metragemC"]').classList.remove("hidden");
      } else {
        document.getElementById("metragemC").classList.add("hidden");
        document.querySelector('label[for="metragemC"]').classList.add("hidden");
      }
    });

    // Atualizar imagem ao selecionar o tipo de telha
    document.getElementById("tipoTelha").addEventListener("change", function () {
      const tipoTelha = this.options[this.selectedIndex].parentElement.label;
      const imgTelha = document.getElementById("imagemTelha");
      if (tipoTelha.includes("Trapezoidais")) {
        imgTelha.src = imagensTelhas.trapezoidal;
      } else if (tipoTelha.includes("Onduladas")) {
        imgTelha.src = imagensTelhas.ondulada;
      }
      imgTelha.classList.remove("hidden");
    });

    // Fun√ß√£o para calcular √°rea, quantidade de telhas e valor total
    function calcular() {
      const tipoCobertura = document.getElementById("tipoCobertura").value;
      const metragemA = parseFloat(document.getElementById("metragemA").value) || 0;
      const metragemB = parseFloat(document.getElementById("metragemB").value) || 0;
      const metragemC = parseFloat(document.getElementById("metragemC").value) || 0;

      // Validar campos obrigat√≥rios
      if (metragemA <= 0 || metragemB <= 0) {
        alert("Por favor, preencha as metragens A e B corretamente.");
        return;
      }

      if (tipoCobertura === "duasAbasAssimetricas" && metragemC <= 0) {
        alert("Por favor, preencha a metragem C para telhados com duas abas assim√©tricas.");
        return;
      }

      // Calcular √°rea do telhado
      let areaTelhado;
      if (tipoCobertura === "umaInclinacao" || tipoCobertura === "duasAbasSimetricas") {
        areaTelhado = metragemA * metragemB;
      } else if (tipoCobertura === "duasAbasAssimetricas") {
        areaTelhado = (metragemA * metragemB) + (metragemA * metragemC);
      }

      // Calcular √°rea √∫til da telha (considerando sobreposi√ß√µes)
      const medidasTelha = document.getElementById("tipoTelha").value.split("x");
      const comprimentoTelha = parseFloat(medidasTelha[0]); // Em metros
      const larguraTelha = parseFloat(medidasTelha[1]); // Em metros

      // Sobreposi√ß√µes
      const sobreposicaoLateral = 0.1; // 10 cm
      const sobreposicaoLongitudinal = 0.2; // 20 cm

      const larguraUtil = larguraTelha - sobreposicaoLateral;
      const comprimentoUtil = comprimentoTelha - sobreposicaoLongitudinal;
      const areaUtilTelha = larguraUtil * comprimentoUtil;

      // Quantidade de telhas necess√°rias
      const quantidadeTelhas = Math.ceil(areaTelhado / areaUtilTelha);

      // Valor total (R$ 180,00 por telha)
      const valorTotal = quantidadeTelhas * 180;

      // Exibir resultados
      document.getElementById("areaTotal").textContent = areaTelhado.toFixed(2);
      document.getElementById("quantidadeTelhas").textContent = quantidadeTelhas;
      document.getElementById("valorTotal").textContent = valorTotal.toFixed(2);

      // Detalhes da sobreposi√ß√£o
      document.getElementById("detalhesSobreposicao").innerHTML = `
        <strong>Considerando as sobreposi√ß√µes:</strong><br>
        - Sobreposi√ß√£o lateral: ${sobreposicaoLateral * 100} cm (largura √∫til: ${larguraUtil.toFixed(2)} m)<br>
        - Sobreposi√ß√£o longitudinal: ${sobreposicaoLongitudinal * 100} cm (comprimento √∫til: ${comprimentoUtil.toFixed(2)} m)<br>
        - √Årea √∫til de cada telha: ${areaUtilTelha.toFixed(2)} m¬≤<br>
        <em>Obs.: Caso sua largura ou comprimento estejam incorretos, me avise para refazer os c√°lculos! üòä</em>
      `;

      // Mostrar se√ß√£o de resultados
      document.getElementById("resultado").classList.remove("hidden");
    }

    // Fun√ß√£o para gerar n√∫mero de pedido crescente
    function gerarNumeroPedido() {
      let ultimoPedido = localStorage.getItem("ultimoPedido");
      if (!ultimoPedido) {
        ultimoPedido = 1000; // Inicia a partir de 1000
      } else {
        ultimoPedido = parseInt(ultimoPedido) + 1; // Incrementa o n√∫mero do pedido
      }
      localStorage.setItem("ultimoPedido", ultimoPedido);
      return ultimoPedido;
    }

    // Fun√ß√£o para gerar PDF
    function gerarPDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();

      // Adicionar logotipo no canto superior esquerdo
      const logoUrl = "https://gabriellemoreira.com.br/wp-content/uploads/2025/02/braco-forte.jpeg";
      const logoWidth = 30;
      const logoHeight = 15;
      doc.addImage(logoUrl, "JPEG", 10, 10, logoWidth, logoHeight);

      // Gerar n√∫mero de pedido
      const numeroPedido = gerarNumeroPedido();

      // T√≠tulo
      doc.setFontSize(18);
      doc.text("Or√ßamento de Coberturas", 70, 20);

      // Informa√ß√µes da Empresa
      doc.setFontSize(12);
      doc.text("EMPRESA DE COBERTURAS DE A√áOS DO KELVYN", 10, 40);
      doc.text("Rua Doutor Lucio Machado 15, S√£o Jo√£o de Meriti", 10, 50);
      doc.text("Or√ßamentos: (21) 98130-4519 gr√°tis!", 10, 60);
      doc.text("Instagram: @bracofortecoberturas", 10, 70);

      // N√∫mero do Pedido
      doc.setFontSize(14);
      doc.text(`N√∫mero do Pedido: ${numeroPedido}`, 10, 90);

      // Dados do Or√ßamento
      doc.setFontSize(14);
      doc.text("Detalhes do Or√ßamento:", 10, 110);
      doc.setFontSize(12);
      doc.text(`√Årea do telhado: ${document.getElementById("areaTotal").textContent} m¬≤`, 10, 120);
      doc.text(`Quantidade de telhas: ${document.getElementById("quantidadeTelhas").textContent}`, 10, 130);
      doc.text(`Valor total: R$ ${document.getElementById("valorTotal").textContent}`, 10, 140);

      // Salvar o PDF e abrir em uma nova aba
      const pdfBlob = doc.output("blob");
      const pdfUrl = URL.createObjectURL(pdfBlob);
      const newWindow = window.open(pdfUrl, "_blank");
      if (!newWindow) {
        alert("Por favor, permita pop-ups para visualizar o PDF.");
      }
    }

    // Fun√ß√£o para enviar or√ßamento via WhatsApp
    function enviarWhatsApp() {
      const nomeCliente = document.getElementById("nomeCliente").value;
      const telefoneCliente = document.getElementById("telefoneCliente").value;
      
      if (!nomeCliente || !telefoneCliente) {
        alert("Por favor, preencha seu nome e telefone antes de enviar o or√ßamento.");
        return;
      }

      if (!document.getElementById("resultado").classList.contains("hidden")) {
        const numeroPedido = gerarNumeroPedido();
        const areaTotal = document.getElementById("areaTotal").textContent;
        const quantidadeTelhas = document.getElementById("quantidadeTelhas").textContent;
        const valorTotal = document.getElementById("valorTotal").textContent;
        const tipoCobertura = document.getElementById("tipoCobertura").options[document.getElementById("tipoCobertura").selectedIndex].text;
        const tipoTelha = document.getElementById("tipoTelha").options[document.getElementById("tipoTelha").selectedIndex].text;

        // Montar mensagem
        let mensagem = `*Or√ßamento de Coberturas*\n\n`;
        mensagem += `Boa tarde, segue meu or√ßamento, fico no aguardo da resposta para fecharmos neg√≥cio:\n\n`;
        mensagem += `*Nome do Cliente:* ${nomeCliente}\n`;
        mensagem += `*Telefone:* ${telefoneCliente}\n\n`;
        mensagem += `*N√∫mero do Pedido:* ${numeroPedido}\n`;
        mensagem += `*Detalhes do Or√ßamento:*\n`;
        mensagem += `- Tipo de Cobertura: ${tipoCobertura}\n`;
        mensagem += `- Tipo de Telha: ${tipoTelha}\n`;
        mensagem += `- √Årea do telhado: ${areaTotal} m¬≤\n`;
        mensagem += `- Quantidade de telhas: ${quantidadeTelhas}\n`;
        mensagem += `- Valor total: R$ ${valorTotal}\n\n`;
        mensagem += `----------------------------\n`;
        mensagem += `*DADOS DA COTADA:*\n`;
        mensagem += `EMPRESA DE COBERTURAS DE A√áOS DO KELVYN\n`;
        mensagem += `Rua Doutor Lucio Machado 15, S√£o Jo√£o de Meriti\n`;
        mensagem += `Or√ßamentos: (21) 98130-4519 gr√°tis!\n`;
        mensagem += `Instagram: @bracofortecoberturas`;

        // Codificar a mensagem para URL
        const mensagemCodificada = encodeURIComponent(mensagem);
        
        // N√∫mero de WhatsApp da empresa
        const numeroWhatsApp = "5521981304519";
        
        // Criar link do WhatsApp
        const urlWhatsApp = `https://wa.me/${numeroWhatsApp}?text=${mensagemCodificada}`;
        
        // Abrir WhatsApp em nova aba
        window.open(urlWhatsApp, '_blank');
      } else {
        alert("Por favor, calcule o or√ßamento antes de enviar.");
      }
    }
  </script>
</body>
</html>
